     1                                  ; back port from GOGO-no coda 2.24b by Takehiro TOMINAGA
     2                                  
     3                                  ; GOGO-no-coda
     4                                  ;	Copyright (C) 1999 shigeo
     5                                  ;	special thanks to Keiichi SAKAI
     6                                   
     7                                  %include "nasm.h"
     1                              <1> 
     2                              <1> ;	Copyright (C) 1999 URURI
     3                              <1> 
     4                              <1> ;	nasmï¿½Ñ¥Þ¥ï¿½ï¿½ï¿½
     5                              <1> ;	1999/08/21 ï¿½ï¿½ï¿½
     6                              <1> ;	1999/10/10 ï¿½ï¿½ï¿½Ä¤ï¿½ï¿½É²ï¿½
     7                              <1> ;	1999/10/27 aoutï¿½Ð±ï¿½
     8                              <1> ;	1999/11/07 pushf, popf ï¿½ï¿½NASMï¿½Î¥Ð¥ï¿½ï¿½Ð±ï¿½
     9                              <1> ;	1999/12/02 for BCC ( Thanks to Miquel )
    10                              <1> 
    11                              <1> ; for Windows Visual C++        -> define WIN32
    12                              <1> ;             Borland or cygwin ->        WIN32 and COFF
    13                              <1> ; for FreeBSD 2.x               ->        AOUT
    14                              <1> ; for TownsOS                   ->        __tos__
    15                              <1> ; otherwise                     ->   none
    16                              <1> 
    17                              <1> ;Ì¾ï¿½ï¿½ï¿½ï¿½Õ¤ï¿½ï¿½ï¿½
    18                              <1> 
    19                              <1> BITS 32
    20                              <1> 
    21                              <1> section .note.GNU-stack noalloc noexec nowrite progbits
    22                              <1> 
    23                              <1> %ifdef YASM
    24                              <1> 	%define segment_code segment .text align=16 use32
    25                              <1> 	%define segment_data segment .data align=16 use32
    26                              <1> 	%define segment_bss  segment .bss align=16 use32
    27                              <1> %elifdef WIN32
    28                              <1> 	%define segment_code segment .text align=16 class=CODE use32
    29                              <1> 	%define segment_data segment .data align=16 class=DATA use32
    30                              <1> %ifdef __BORLANDC__
    31                              <1> 	%define segment_bss  segment .data align=16 class=DATA use32
    32                              <1> %else
    33                              <1> 	%define segment_bss  segment .bss align=16 class=DATA use32
    34                              <1> %endif
    35                              <1> %elifdef AOUT
    36                              <1> 	%define _NAMING
    37                              <1> 	%define segment_code segment .text
    38                              <1> 	%define segment_data segment .data
    39                              <1> 	%define segment_bss  segment .bss
    40                              <1> %else
    41                              <1> %ifidn __OUTPUT_FORMAT__,elf
    42                              <1> 	section .note.GNU-stack progbits noalloc noexec nowrite align=1
    43                              <1> %endif
    44                              <1> 	%define segment_code segment .text align=16 class=CODE use32
    45                              <1> 	%define segment_data segment .data align=16 class=DATA use32
    46                              <1> 	%define segment_bss  segment .bss align=16 class=DATA use32
    47                              <1> %endif
    48                              <1> 
    49                              <1> %ifdef WIN32
    50                              <1> 	%define _NAMING
    51                              <1> %endif
    52                              <1> 
    53                              <1> %ifdef __tos__
    54                              <1> group CGROUP text
    55                              <1> group DGROUP data
    56                              <1> %endif
    57                              <1> 
    58                              <1> ;Ã±ï¿½ï¿½ï¿½ï¿½ï¿½Æ°ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
    59                              <1> 
    60                              <1> %idefine float dword
    61                              <1> %idefine fsize 4
    62                              <1> %idefine fsizen(a) (fsize*(a))
    63                              <1> 
    64                              <1> ;ï¿½ï¡¼ï¿½É·ï¿½ï¿½
    65                              <1> 
    66                              <1> %idefine wsize 2
    67                              <1> %idefine wsizen(a) (wsize*(a))
    68                              <1> %idefine dwsize 4
    69                              <1> %idefine dwsizen(a) (dwsize*(a))
    70                              <1> 
    71                              <1> ;REG
    72                              <1> 
    73                              <1> %define r0 eax
    74                              <1> %define r1 ebx
    75                              <1> %define r2 ecx
    76                              <1> %define r3 edx
    77                              <1> %define r4 esi
    78                              <1> %define r5 edi
    79                              <1> %define r6 ebp
    80                              <1> %define r7 esp
    81                              <1> 
    82                              <1> ;MMX,3DNow!,SSE
    83                              <1> 
    84                              <1> %define pmov	movq
    85                              <1> %define pmovd	movd
    86                              <1> 
    87                              <1> %define pupldq	punpckldq
    88                              <1> %define puphdq	punpckhdq
    89                              <1> %define puplwd	punpcklwd
    90                              <1> %define puphwd	punpckhwd
    91                              <1> 
    92                              <1> %define xm0 xmm0
    93                              <1> %define xm1 xmm1
    94                              <1> %define xm2 xmm2
    95                              <1> %define xm3 xmm3
    96                              <1> %define xm4 xmm4
    97                              <1> %define xm5 xmm5
    98                              <1> %define xm6 xmm6
    99                              <1> %define xm7 xmm7
   100                              <1> 
   101                              <1> ;ï¿½ï¿½ï¿½ï¿½ï¿½Ã¥Õ¥ï¿½ï¿½Ñ¤ï¿½4ï¿½Ê¥Þ¥ï¿½ï¿½ï¿½
   102                              <1> 
   103                              <1> %define R4(a,b,c,d) (a*64+b*16+c*4+d)
   104                              <1> 
   105                              <1> ;Cï¿½é¥¤ï¿½ï¿½ï¿½Ê´Ê°×¥Þ¥ï¿½ï¿½ï¿½
   106                              <1> 
   107                              <1> %imacro globaldef 1
   108                              <1> 	%ifdef _NAMING
   109                              <1> 		%define %1 _%1
   110                              <1> 	%endif
   111                              <1> 	global %1
   112                              <1> %endmacro
   113                              <1> 
   114                              <1> %imacro externdef 1
   115                              <1> 	%ifdef _NAMING
   116                              <1> 		%define %1 _%1
   117                              <1> 	%endif
   118                              <1> 	extern %1
   119                              <1> %endmacro
   120                              <1> 
   121                              <1> %imacro proc 1
   122                              <1> 	%push	proc
   123                              <1> 	%ifdef _NAMING
   124                              <1> 		global _%1
   125                              <1> 	%else
   126                              <1> 		global %1
   127                              <1> 	%endif
   128                              <1> 
   129                              <1> 	align 32
   130                              <1> %1:
   131                              <1> _%1:
   132                              <1> 
   133                              <1> 	%assign %$STACK 0
   134                              <1> 	%assign %$STACKN 0
   135                              <1> 	%assign %$ARG 4
   136                              <1> %endmacro
   137                              <1> 
   138                              <1> %imacro endproc 0
   139                              <1> 	%ifnctx proc
   140                              <1> 		%error expected 'proc' before 'endproc'.
   141                              <1> 	%else
   142                              <1> 		%if %$STACK > 0
   143                              <1> 			add esp, %$STACK
   144                              <1> 		%endif
   145                              <1> 
   146                              <1> 		%if %$STACK <> (-%$STACKN)
   147                              <1> 			%error STACKLEVEL mismatch check 'local', 'alloc', 'pushd', 'popd'
   148                              <1> 		%endif
   149                              <1> 
   150                              <1> 		ret
   151                              <1> 		%pop
   152                              <1> 	%endif
   153                              <1> %endmacro
   154                              <1> 
   155                              <1> %idefine sp(a) esp+%$STACK+a
   156                              <1> 
   157                              <1> %imacro arg 1
   158                              <1> 	%00	equ %$ARG
   159                              <1> 	%assign %$ARG %$ARG+%1
   160                              <1> %endmacro
   161                              <1> 
   162                              <1> %imacro local 1
   163                              <1> 	%assign %$STACKN %$STACKN-%1
   164                              <1> 	%00 equ %$STACKN
   165                              <1> %endmacro
   166                              <1> 
   167                              <1> %imacro alloc 0
   168                              <1> 	sub esp, (-%$STACKN)-%$STACK
   169                              <1> 	%assign %$STACK (-%$STACKN)
   170                              <1> %endmacro
   171                              <1> 
   172                              <1> %imacro pushd 1-*
   173                              <1> 	%rep %0
   174                              <1> 		push %1
   175                              <1> 		%assign %$STACK %$STACK+4
   176                              <1> 	%rotate 1
   177                              <1> 	%endrep
   178                              <1> %endmacro
   179                              <1> 
   180                              <1> %imacro popd 1-*
   181                              <1> 	%rep %0
   182                              <1> 	%rotate -1
   183                              <1> 		pop %1
   184                              <1> 		%assign %$STACK %$STACK-4
   185                              <1> 	%endrep
   186                              <1> %endmacro
   187                              <1> 
   188                              <1> ; bug of NASM-0.98
   189                              <1> %define pushf db 0x66, 0x9C
   190                              <1> %define popf  db 0x66, 0x9D
   191                              <1> 
   192                              <1> %define	ge16(n)		((((n) / 16)*0xFFFFFFFF) & 0xFFFFFFFF)
   193                              <1> %define	ge15(n)		((((n) / 15)*0xFFFFFFFF) & 0xFFFFFFFF)
   194                              <1> %define	ge14(n)		((((n) / 14)*0xFFFFFFFF) & 0xFFFFFFFF)
   195                              <1> %define	ge13(n)		((((n) / 13)*0xFFFFFFFF) & 0xFFFFFFFF)
   196                              <1> %define	ge12(n)		((((n) / 12)*0xFFFFFFFF) & 0xFFFFFFFF)
   197                              <1> %define	ge11(n)		((((n) / 11)*0xFFFFFFFF) & 0xFFFFFFFF)
   198                              <1> %define	ge10(n)		((((n) / 10)*0xFFFFFFFF) & 0xFFFFFFFF)
   199                              <1> %define	ge9(n)		((((n) /  9)*0xFFFFFFFF) & 0xFFFFFFFF)
   200                              <1> %define	ge8(n)		(ge9(n) | ((((n) /  8)*0xFFFFFFFF) & 0xFFFFFFFF))
   201                              <1> %define	ge7(n)		(ge9(n) | ((((n) /  7)*0xFFFFFFFF) & 0xFFFFFFFF))
   202                              <1> %define	ge6(n)		(ge9(n) | ((((n) /  6)*0xFFFFFFFF) & 0xFFFFFFFF))
   203                              <1> %define	ge5(n)		(ge9(n) | ((((n) /  5)*0xFFFFFFFF) & 0xFFFFFFFF))
   204                              <1> %define	ge4(n)		(ge5(n) | ((((n) /  4)*0xFFFFFFFF) & 0xFFFFFFFF))
   205                              <1> %define	ge3(n)		(ge5(n) | ((((n) /  3)*0xFFFFFFFF) & 0xFFFFFFFF))
   206                              <1> %define	ge2(n)		(ge3(n) | ((((n) /  2)*0xFFFFFFFF) & 0xFFFFFFFF))
   207                              <1> %define	ge1(n)		(ge2(n) | ((((n) /  1)*0xFFFFFFFF) & 0xFFFFFFFF))
   208                              <1> 
   209                              <1> ; macro to align for begining of loop
   210                              <1> ; %1   does not align if it LE bytes to next alignment 
   211                              <1> ;      4..16 
   212                              <1> ;      default is 12
   213                              <1> 
   214                              <1> %imacro	loopalignK6	0-1 12 
   215                              <1> %%here:
   216                              <1> 	times (($$-%%here) & 15 & ge1(($$-%%here) & 15) & ~ge4(($$-%%here) & 15)) nop
   217                              <1> 	times (1                & ge4(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) jmp short %%skip
   218                              <1> 	times (((($$-%%here) & 15)-2) & ge4(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) nop
   219                              <1> %%skip:
   220                              <1> %endmacro
   221                              <1> 
   222                              <1> %imacro	loopalignK7	0-1 12 
   223                              <1> %%here:
   224                              <1> 	times (1 & ge1(($$-%%here) & 15)  & ~ge2(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) nop
   225                              <1> 	times (1 & ge2(($$-%%here) & 15)  & ~ge3(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Bh,0C0h
   226                              <1> 	times (1 & ge3(($$-%%here) & 15)  & ~ge4(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,020h
   227                              <1> 	times (1 & ge4(($$-%%here) & 15)  & ~ge5(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h
   228                              <1> 	times (1 & ge5(($$-%%here) & 15)  & ~ge6(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h,090h
   229                              <1> 	times (1 & ge6(($$-%%here) & 15)  & ~ge7(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Dh,080h,0,0,0,0
   230                              <1> 	times (1 & ge7(($$-%%here) & 15)  & ~ge8(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0
   231                              <1> 	times (1 & ge8(($$-%%here) & 15)  & ~ge9(($$-%%here) & 15)  & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0,90h
   232                              <1> 	times (1 & ge9(($$-%%here) & 15)  & ~ge10(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,007h,90h,90h,90h,90h,90h,90h,90h
   233                              <1> 	times (1 & ge10(($$-%%here) & 15) & ~ge11(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,008h,90h,90h,90h,90h,90h,90h,90h,90h
   234                              <1> 	times (1 & ge11(($$-%%here) & 15) & ~ge12(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,009h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   235                              <1> 	times (1 & ge12(($$-%%here) & 15) & ~ge13(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ah,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   236                              <1> 	times (1 & ge13(($$-%%here) & 15) & ~ge14(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Bh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   237                              <1> 	times (1 & ge14(($$-%%here) & 15) & ~ge15(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ch,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   238                              <1> 	times (1 & ge15(($$-%%here) & 15) & ~ge16(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Dh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   239                              <1> %%skip:
   240                              <1> %endmacro
   241                              <1> 
   242                              <1> %imacro	loopalign	0-1 12 
   243                              <1> 	loopalignK7 %1
   244                              <1> %endmacro
   245                              <1> %define PACK(x,y,z,w)	(x*64+y*16+z*4+w)
   246                              <1> 
   247                              <1> %ifidn __OUTPUT_FORMAT__,elf
   248                              <1> 
   249                              <1> %idefine PIC_BASE(A) _GLOBAL_OFFSET_TABLE_ + $$ - $ wrt ..gotpc
   250                              <1> %idefine PIC_EBP_REL(A) ebp + A wrt ..gotoff
   251                              <1> %macro PIC_OFFSETTABLE 0
   252                              <1> extern  _GLOBAL_OFFSET_TABLE_
   253                              <1> get_pc.bp:
   254                              <1> 	mov ebp, [esp]
   255                              <1> 	retn
   256                              <1> %endmacro
   257                              <1> 
   258                              <1> %else
   259                              <1> 
   260                              <1> %define PIC_BASE(A) (0)
   261                              <1> %define PIC_EBP_REL(A) (A)
   262                              <1> %macro PIC_OFFSETTABLE 0
   263                              <1> get_pc.bp:
   264                              <1> 	mov ebp, [esp]
   265                              <1> 	retn
   266                              <1> %endmacro
   267                              <1> 
   268                              <1> %endif
     8                                  
     9                                  	globaldef fht_SSE
     9                              <1>  %ifdef _NAMING
     9                              <1>  %define %1 _%1
     9                              <1>  %endif
     9                              <1>  global %1
    10                                  
    11                                  	segment_data
    12                                  	align 16
    13 00000000 000000000000000000-     Q_MMPP	dd	0x0,0x0,0x80000000,0x80000000
    13 00000009 00008000000080     
    14 00000010 000000000000008000-     Q_MPMP	dd	0x0,0x80000000,0x0,0x80000000
    14 00000019 00000000000080     
    15 00000020 000000000000000000-     D_1100	dd 0.0, 0.0, 1.0, 1.0
    15 00000029 00803F0000803F     
    16                                  costab_fft:
    17 00000030 5E836C3F                	dd 9.238795325112867e-01
    18 00000034 15EFC33E                	dd 3.826834323650898e-01
    19 00000038 6DC47E3F                	dd 9.951847266721969e-01
    20 0000003C 36BDC83D                	dd 9.801714032956060e-02
    21 00000040 43EC7F3F                	dd 9.996988186962042e-01
    22 00000044 B00AC93C                	dd 2.454122852291229e-02
    23 00000048 C4FE7F3F                	dd 9.999811752836011e-01
    24 0000004C 880FC93B                	dd 6.135884649154475e-03
    25 00000050 F304B53F                S_SQRT2	dd	1.414213562
    26                                  
    27                                  	segment_code
    28                                  
    29                                  PIC_OFFSETTABLE
    29                              <1> extern _GLOBAL_OFFSET_TABLE_
    29                              <1> get_pc.bp:
    29 00000000 8B2C24              <1>  mov ebp, [esp]
    29 00000003 C3                  <1>  retn
    30                                  
    31                                  ;------------------------------------------------------------------------
    32                                  ;	by K. SAKAI
    33                                  ;	99/08/18	PIII 23k[clk]
    34                                  ;	99/08/19	Ì¿Îá½ç½øÆþ¤ì´¹¤¨ PIII 22k[clk]
    35                                  ;	99/08/20	bit reversal ¤òµì¸á¸å¤«¤é°Ü¿¢¤·¤¿ PIII 17k[clk]
    36                                  ;	99/08/23	°ìÉô unroll PIII 14k[clk]
    37                                  ;	99/11/12	clean up
    38                                  ;
    39                                  ;void fht_SSE(float *fz, int n);
    40 00000004 90<rept>                	align 16
    41                                  fht_SSE:
    42 00000010 53                      	push	ebx
    43 00000011 56                      	push	esi
    44 00000012 57                      	push	edi
    45 00000013 55                      	push	ebp
    46                                  
    47                                  %assign _P 4*5
    48                                  
    49                                  	;2¤ÄÌÜ¤Î¥ë¡¼¥×
    50 00000014 8B442414                	mov	eax,[esp+_P+0]	;eax=fz
    51 00000018 8B6C2418                	mov	ebp,[esp+_P+4]	;=n
    52 0000001C C1E503                  	shl	ebp,3
    53 0000001F 01C5                    	add	ebp,eax		; fn  = fz + n, ¤³¤Î´Ø¿ô½ªÎ»¤Þ¤ÇÉÔÊÑ
    54 00000021 55                      	push	ebp
    55                                  
    56 00000022 E8D9FFFFFF              	call	get_pc.bp
    57 00000027 81C5[D9FFFFFF]          	add	ebp, PIC_BASE()
    58                                  
    59 0000002D 8D8D[30000000]          	lea	ecx,[PIC_EBP_REL(costab_fft)]
    60 00000033 31C0                    	xor	eax,eax
    61 00000035 B008                    	mov	al,8		; =k1=1*(sizeof float)	// 4, 16, 64, 256,...
    62                                  .lp2:				; do{
    63 00000037 8B742418                	mov	esi,[esp+_P+4]	; esi=fi=fz
    64 0000003B 8D1440                  	lea	edx,[eax+eax*2]
    65 0000003E 89F3                    	mov	ebx, esi
    66                                  
    67                                  ; ¤¿¤«¤À¤«2ÊÂÎó¤·¤«´üÂÔ¤Ç¤­¤Ê¤¤ÉôÊ¬¤ÏFPU¤Î¤Û¤¦¤¬Â®¤¤¡£
    68                                  	loopalign	16
    68                              <1>  loopalignK7 %1
    68                              <2> %%here:
    68                              <2>  times (1 & ge1(($$-%%here) & 15) & ~ge2(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) nop
    68                              <2>  times (1 & ge2(($$-%%here) & 15) & ~ge3(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Bh,0C0h
    68                              <2>  times (1 & ge3(($$-%%here) & 15) & ~ge4(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,020h
    68                              <2>  times (1 & ge4(($$-%%here) & 15) & ~ge5(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h
    68                              <2>  times (1 & ge5(($$-%%here) & 15) & ~ge6(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h,090h
    68                              <2>  times (1 & ge6(($$-%%here) & 15) & ~ge7(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,080h,0,0,0,0
    68                              <2>  times (1 & ge7(($$-%%here) & 15) & ~ge8(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0
    68                              <2>  times (1 & ge8(($$-%%here) & 15) & ~ge9(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0,90h
    68                              <2>  times (1 & ge9(($$-%%here) & 15) & ~ge10(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,007h,90h,90h,90h,90h,90h,90h,90h
    68                              <2>  times (1 & ge10(($$-%%here) & 15) & ~ge11(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,008h,90h,90h,90h,90h,90h,90h,90h,90h
    68                              <2>  times (1 & ge11(($$-%%here) & 15) & ~ge12(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,009h,90h,90h,90h,90h,90h,90h,90h,90h,90h
    68                              <2>  times (1 & ge12(($$-%%here) & 15) & ~ge13(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ah,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
    68                              <2>  times (1 & ge13(($$-%%here) & 15) & ~ge14(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Bh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
    68                              <2>  times (1 & ge14(($$-%%here) & 15) & ~ge15(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ch,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
    68                              <2>  times (1 & ge15(($$-%%here) & 15) & ~ge16(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Dh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
    68                              <2> %%skip:
    69                                  .lp20:				; do{
    70                                  ;                       f0     = fi[0 ] + fi[k1];
    71                                  ;                       f2     = fi[k2] + fi[k3];
    72                                  ;                       f1     = fi[0 ] - fi[k1];
    73                                  ;                       f3     = fi[k2] - fi[k3];
    74                                  ;                       fi[0 ] = f0     + f2;
    75                                  ;                       fi[k1] = f1     + f3;
    76                                  ;                       fi[k2] = f0     - f2;
    77                                  ;                       fi[k3] = f1     - f3;
    78 00000040 8D3C03                  	lea	edi,[ebx+eax]	; edi=gi=fi+ki/2
    79 00000043 D903                    	fld	dword [ebx]
    80 00000045 D80443                  	fadd	dword [ebx+eax*2]
    81 00000048 D90483                  	fld	dword [ebx+eax*4]
    82 0000004B D80453                  	fadd	dword [ebx+edx*2]
    83                                  
    84 0000004E D903                    	fld	dword [ebx]
    85 00000050 D82443                  	fsub	dword [ebx+eax*2]
    86 00000053 D90483                  	fld	dword [ebx+eax*4]
    87 00000056 D82453                  	fsub	dword [ebx+edx*2]
    88                                  
    89 00000059 D9C1                    	fld	st1
    90 0000005B D8C1                    	fadd	st0,st1
    91 0000005D D91C43                  	fstp	dword [ebx+eax*2]
    92 00000060 DEE9                    	fsubp	st1,st0
    93 00000062 D91C53                  	fstp	dword [ebx+edx*2]
    94                                  
    95 00000065 D9C1                    	fld	st1
    96 00000067 D8C1                    	fadd	st0,st1
    97 00000069 D91B                    	fstp	dword [ebx]
    98 0000006B DEE9                    	fsubp	st1,st0
    99 0000006D D91C83                  	fstp	dword [ebx+eax*4]
   100                                  
   101 00000070 8D1CC3                  	lea	ebx,[ebx + eax*8]	; = fi += (k1 * 4);
   102                                  ;                       g0     = gi[0 ] + gi[k1];
   103                                  ;                       g2     = SQRT2  * gi[k2];
   104                                  ;                       g1     = gi[0 ] - gi[k1];
   105                                  ;                       g3     = SQRT2  * gi[k3];
   106                                  ;                       gi[0 ] = g0     + g2;
   107                                  ;                       gi[k2] = g0     - g2;
   108                                  ;                       gi[k1] = g1     + g3;
   109                                  ;                       gi[k3] = g1     - g3;
   110 00000073 D907                    	fld	dword [edi]
   111 00000075 D80447                  	fadd	dword [edi+eax*2]
   112 00000078 D985[50000000]          	fld	dword [PIC_EBP_REL(S_SQRT2)]
   113 0000007E D80C87                  	fmul	dword [edi+eax*4]
   114                                  
   115 00000081 D907                    	fld	dword [edi]
   116 00000083 D82447                  	fsub	dword [edi+eax*2]
   117 00000086 D985[50000000]          	fld	dword [PIC_EBP_REL(S_SQRT2)]
   118 0000008C D80C57                  	fmul	dword [edi+edx*2]
   119                                  
   120 0000008F D9C1                    	fld	st1
   121 00000091 D8C1                    	fadd	st0,st1
   122 00000093 D91C47                  	fstp	dword [edi+eax*2]
   123 00000096 DEE9                    	fsubp	st1,st0
   124 00000098 D91C57                  	fstp	dword [edi+edx*2]
   125                                  
   126 0000009B D9C1                    	fld	st1
   127 0000009D D8C1                    	fadd	st0,st1
   128 0000009F D91F                    	fstp	dword [edi]
   129 000000A1 DEE9                    	fsubp	st1,st0
   130 000000A3 D91C87                  	fstp	dword [edi+eax*4]
   131                                  
   132 000000A6 3B1C24                  	cmp	ebx,[esp]
   133 000000A9 0F8C91FFFFFF            	jl	near .lp20		; while (fi<fn);
   134                                  
   135                                  
   136                                  ;               i = 1; //for (i=1;i<kx;i++){
   137                                  ;                       c1 = 1.0*t_c - 0.0*t_s;
   138                                  ;                       s1 = 0.0*t_c + 1.0*t_s;
   139 000000AF 0F1231                  	movlps	xmm6,[ecx] ; = { --,  --,  s1, c1}
   140 000000B2 0F28FE                  	movaps	xmm7,xmm6
   141                                  
   142 000000B5 0FC6F614                	shufps	xmm6,xmm6,R4(0,1,1,0)	; = {+c1, +s1, +s1, +c1} -> É¬Í×
   143                                  ;                       c2 = c1*c1 - s1*s1 = 1 - (2*s1)*s1;
   144                                  ;                       s2 = c1*s1 + s1*c1 = 2*s1*c1;
   145 000000B9 0FC6FF41                	shufps	xmm7,xmm7,R4(1,0,0,1)
   146 000000BD F30F10EF                	movss	xmm5,xmm7		; = { --,  --,  --, s1}
   147 000000C1 0F57BD[00000000]        	xorps	xmm7,[PIC_EBP_REL(Q_MMPP)]	; = {-s1, -c1, +c1, +s1} -> É¬Í×
   148                                  
   149 000000C8 F30F58ED                	addss	xmm5,xmm5		; = (--, --,  --, 2*s1)
   150 000000CC 83C604                  	add	esi,4		; esi = fi = fz + i
   151 000000CF 0FC6ED00                	shufps	xmm5,xmm5,R4(0,0,0,0)	; = (2*s1, 2*s1, 2*s1, 2*s1)
   152 000000D3 0F59EE                  	mulps	xmm5,xmm6		; = (2*s1*c1, 2*s1*s1, 2*s1*s1, 2*s1*c1)
   153 000000D6 0F5CAD[20000000]        	subps	xmm5,[PIC_EBP_REL(D_1100)]		; = (--, 2*s1*s1-1, --, 2*s1*c1) = {-- -c2 -- s2}
   154 000000DD 0F28E5                  	movaps	xmm4,xmm5
   155 000000E0 0FC6ED88                	shufps	xmm5,xmm5,R4(2,0,2,0)	; = {-c2, s2, -c2, s2} -> É¬Í×
   156                                  
   157 000000E4 0F57A5[00000000]        	xorps	xmm4,[PIC_EBP_REL(Q_MMPP)]		; = {--, c2, --, s2}
   158 000000EB 0FC6E422                	shufps	xmm4,xmm4,R4(0,2,0,2)	; = {s2, c2, s2, c2} -> É¬Í×
   159                                  
   160                                  	loopalign	16
   160                              <1>  loopalignK7 %1
   160                              <2> %%here:
   160 000000EF 90                  <2>  times (1 & ge1(($$-%%here) & 15) & ~ge2(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) nop
   160                              <2>  times (1 & ge2(($$-%%here) & 15) & ~ge3(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Bh,0C0h
   160                              <2>  times (1 & ge3(($$-%%here) & 15) & ~ge4(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,020h
   160                              <2>  times (1 & ge4(($$-%%here) & 15) & ~ge5(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h
   160                              <2>  times (1 & ge5(($$-%%here) & 15) & ~ge6(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h,090h
   160                              <2>  times (1 & ge6(($$-%%here) & 15) & ~ge7(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,080h,0,0,0,0
   160                              <2>  times (1 & ge7(($$-%%here) & 15) & ~ge8(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0
   160                              <2>  times (1 & ge8(($$-%%here) & 15) & ~ge9(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0,90h
   160                              <2>  times (1 & ge9(($$-%%here) & 15) & ~ge10(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,007h,90h,90h,90h,90h,90h,90h,90h
   160                              <2>  times (1 & ge10(($$-%%here) & 15) & ~ge11(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,008h,90h,90h,90h,90h,90h,90h,90h,90h
   160                              <2>  times (1 & ge11(($$-%%here) & 15) & ~ge12(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,009h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   160                              <2>  times (1 & ge12(($$-%%here) & 15) & ~ge13(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ah,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   160                              <2>  times (1 & ge13(($$-%%here) & 15) & ~ge14(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Bh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   160                              <2>  times (1 & ge14(($$-%%here) & 15) & ~ge15(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ch,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   160                              <2>  times (1 & ge15(($$-%%here) & 15) & ~ge16(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Dh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   160                              <2> %%skip:
   161                                  .lp21:				; do{
   162                                  ;                               a       = c2*fi[k1] + s2*gi[k1];
   163                                  ;                               b       = s2*fi[k1] - c2*gi[k1];
   164                                  ;                               c       = c2*fi[k3] + s2*gi[k3];
   165                                  ;                               d       = s2*fi[k3] - c2*gi[k3];
   166                                  ;                               f0      = fi[0 ]        + a;
   167                                  ;                               g0      = gi[0 ]        + b;
   168                                  ;                               f2      = fi[k1 * 2]    + c;
   169                                  ;                               g2      = gi[k1 * 2]    + d;
   170                                  ;                               f1      = fi[0 ]        - a;
   171                                  ;                               g1      = gi[0 ]        - b;
   172                                  ;                               f3      = fi[k1 * 2]    - c;
   173                                  ;                               g3      = gi[k1 * 2]    - d;
   174 000000F0 8D7C46F8                	lea	edi,[esi + eax*2 - 8]	; edi = gi = fz +k1-i
   175                                  
   176 000000F4 F30F100446              	movss	xmm0,[esi + eax*2]	; = fi[k1]
   177 000000F9 F30F101456              	movss	xmm2,[esi + edx*2]	; = fi[k3]
   178 000000FE 0FC6C200                	shufps	xmm0,xmm2,0x00	; = {fi[k3], fi[k3], fi[k1], fi[k1]}
   179 00000102 F30F100C47              	movss	xmm1,[edi + eax*2]	; = fi[k1]
   180 00000107 F30F101C57              	movss	xmm3,[edi + edx*2]	; = fi[k3]
   181 0000010C 0FC6CB00                	shufps	xmm1,xmm3,0x00	; = {gi[k3], gi[k3], gi[k1], gi[k1]}
   182 00000110 F30F1016                	movss	xmm2,[esi]		; = fi[0]
   183 00000114 0F59C4                  	mulps	xmm0,xmm4		; *= {+s2, +c2, +s2, +c2}
   184 00000117 F30F101C86              	movss	xmm3,[esi + eax*4]	; = fi[k2]
   185 0000011C 0F14D3                  	unpcklps	xmm2,xmm3	; = {--, --, fi[k2], fi[0]}
   186 0000011F 0F59CD                  	mulps	xmm1,xmm5		; *= {-c2, +s2, -c2, +s2}
   187 00000122 F30F101C87              	movss	xmm3,[edi + eax*4]	; = gi[k2]
   188 00000127 0F58C1                  	addps	xmm0,xmm1		; = {d, c, b, a}
   189 0000012A F30F100F                	movss	xmm1,[edi]		; = gi[0]
   190 0000012E 0F14CB                  	unpcklps	xmm1,xmm3	; = {--,  --, gi[k2], gi[0]}
   191 00000131 0F14D1                  	unpcklps	xmm2,xmm1	; = {gi[k2], fi[k2], gi[0], fi[0]}
   192 00000134 0F28CA                  	movaps	xmm1,xmm2
   193 00000137 0F58C8                  	addps	xmm1,xmm0	; = {g2, f2, g0, f0}
   194 0000013A 0F5CD0                  	subps	xmm2,xmm0	; = {g3, f3, g1, f1}
   195                                  
   196                                  ;                               a       = c1*f2     + s1*g3;
   197                                  ;                               c       = s1*g2     + c1*f3;
   198                                  ;                               b       = s1*f2     - c1*g3;
   199                                  ;                               d       = c1*g2     - s1*f3;
   200                                  ;                               fi[0 ]  = f0        + a;
   201                                  ;                               gi[0 ]  = g0        + c;
   202                                  ;                               gi[k1]  = g1        + b;
   203                                  ;                               fi[k1]  = f1        + d;
   204                                  ;                               fi[k1 * 2]  = f0    - a;
   205                                  ;                               gi[k1 * 2]  = g0    - c;
   206                                  ;                               gi[k3]      = g1    - b;
   207                                  ;                               fi[k3]      = f1    - d;
   208 0000013D 0F28D9                  	movaps	xmm3,xmm1
   209 00000140 0F12C9                  	movhlps	xmm1,xmm1	; = {g2, f2, g2, f2}
   210 00000143 0FC6DA14                	shufps	xmm3,xmm2,0x14	; = {f1, g1, g0, f0}
   211 00000147 0F59CE                  	mulps	xmm1,xmm6	; *= {+c1, +s1, +s1, +c1}
   212 0000014A 0FC6D2BB                	shufps	xmm2,xmm2,0xBB	; = {f3, g3, f3, g3}
   213 0000014E 0F59D7                  	mulps	xmm2,xmm7	; *= {-s1, -c1, +c1, +s1}
   214 00000151 0F58CA                  	addps	xmm1,xmm2	; = {d, b, c, a}
   215 00000154 0F28D3                  	movaps	xmm2,xmm3
   216 00000157 0F58D9                  	addps	xmm3,xmm1	; = {fi[k1], gi[k1], gi[0], fi[0]}
   217 0000015A 0F5CD1                  	subps	xmm2,xmm1	; = {fi[k3], gi[k3], gi[k1*2], fi[k1*2]}
   218 0000015D 0F12C3                  	movhlps	xmm0,xmm3
   219 00000160 F30F111E                	movss	[esi],xmm3
   220 00000164 0FC6DB55                	shufps	xmm3,xmm3,0x55
   221 00000168 F30F110447              	movss	[edi+eax*2],xmm0
   222 0000016D 0FC6C055                	shufps	xmm0,xmm0,0x55
   223 00000171 F30F111F                	movss	[edi],xmm3
   224 00000175 F30F110446              	movss	[esi+eax*2],xmm0
   225 0000017A 0F12C2                  	movhlps	xmm0,xmm2
   226 0000017D F30F111486              	movss	[esi+eax*4],xmm2
   227 00000182 0FC6D255                	shufps	xmm2,xmm2,0x55
   228 00000186 F30F110457              	movss	[edi+edx*2],xmm0
   229 0000018B 0FC6C055                	shufps	xmm0,xmm0,0x55
   230 0000018F F30F111487              	movss	[edi+eax*4],xmm2
   231 00000194 F30F110456              	movss	[esi+edx*2],xmm0
   232 00000199 8D34C6                  	lea	esi,[esi + eax*8] ; fi += (k1 * 4);
   233 0000019C 3B3424                  	cmp	esi,[esp]
   234 0000019F 0F8C4BFFFFFF            	jl	near .lp21		; while (fi<fn);
   235                                  
   236                                  
   237                                  ; unrollÁ°¤Îdo loop¤Ï43+4Ì¿Îá
   238                                  
   239                                  ; ºÇÆâ¼þ¤Ç¤Ï¤Ê¤¤for¥ë¡¼¥×¤Îi=2¤«¤éÀè¤òunrolling¤·¤¿
   240                                  ; kx=   2,   8,  32,  128
   241                                  ; k4=  16,  64, 256, 1024
   242                                  ;       0, 6/2,30/2,126/2
   243                                  
   244 000001A5 31DB                    	xor	ebx,ebx
   245 000001A7 B308                    	mov	bl, 4*2		; = i = 4
   246 000001A9 39C3                    	cmp	ebx,eax		; i < k1
   247 000001AB 0F8D34010000            	jnl	near .F22
   248                                  ;               for (i=2;i<kx;i+=2){
   249                                  	loopalign	16
   249                              <1>  loopalignK7 %1
   249                              <2> %%here:
   249                              <2>  times (1 & ge1(($$-%%here) & 15) & ~ge2(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) nop
   249                              <2>  times (1 & ge2(($$-%%here) & 15) & ~ge3(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Bh,0C0h
   249                              <2>  times (1 & ge3(($$-%%here) & 15) & ~ge4(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,020h
   249                              <2>  times (1 & ge4(($$-%%here) & 15) & ~ge5(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h
   249                              <2>  times (1 & ge5(($$-%%here) & 15) & ~ge6(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,044h,020h,000h,090h
   249                              <2>  times (1 & ge6(($$-%%here) & 15) & ~ge7(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,080h,0,0,0,0
   249                              <2>  times (1 & ge7(($$-%%here) & 15) & ~ge8(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0
   249                              <2>  times (1 & ge8(($$-%%here) & 15) & ~ge9(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 08Dh,004h,005h,0,0,0,0,90h
   249                              <2>  times (1 & ge9(($$-%%here) & 15) & ~ge10(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,007h,90h,90h,90h,90h,90h,90h,90h
   249                              <2>  times (1 & ge10(($$-%%here) & 15) & ~ge11(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,008h,90h,90h,90h,90h,90h,90h,90h,90h
   249                              <2>  times (1 & ge11(($$-%%here) & 15) & ~ge12(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,009h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   249                              <2>  times (1 & ge12(($$-%%here) & 15) & ~ge13(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ah,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   249                              <2>  times (1 & ge13(($$-%%here) & 15) & ~ge14(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Bh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   249                              <2>  times (1 & ge14(($$-%%here) & 15) & ~ge15(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Ch,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   249 000001B1 EB0D90909090909090- <2>  times (1 & ge15(($$-%%here) & 15) & ~ge16(($$-%%here) & 15) & ~ge%1(($$-%%here) & 15)) DB 0EBh,00Dh,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h,90h
   249 000001BA 909090909090        <2>
   249                              <2> %%skip:
   250                                  .lp22:
   251                                  ; at here, xmm6 is {c3, s3, s3, c3}
   252                                  ;                       c1 = c3*t_c - s3*t_s;
   253                                  ;                       s1 = c3*t_s + s3*t_c;
   254 000001C0 0F1201                  	movlps	xmm0,[ecx]
   255 000001C3 0FC6C050                	shufps	xmm0,xmm0,R4(1,1,0,0)	; = {t_s, t_s, t_c, t_c}
   256 000001C7 0F59F0                  	mulps	xmm6,xmm0	; = {c3*ts, s3*ts, s3*tc, c3*tc}
   257 000001CA 0F12E6                  	movhlps	xmm4,xmm6	; = {--,    --,    c3*ts, s3*ts}
   258 000001CD 0F57A5[10000000]        	xorps	xmm4,[PIC_EBP_REL(Q_MPMP)]	; = {--,    --,   -c3*ts, s3*ts}
   259 000001D4 0F5CF4                  	subps	xmm6,xmm4	; = {-,-, c3*ts+s3*tc, c3*tc-s3*ts}={-,-,s1,c1}
   260                                  
   261                                  ;                       c3 = c1*t_c - s1*t_s;
   262                                  ;                       s3 = s1*t_c + c1*t_s;
   263 000001D7 0FC6F614                	shufps	xmm6,xmm6,0x14	; = {c1, s1, s1, c1}
   264 000001DB 0F59C6                  	mulps	xmm0,xmm6	; = {ts*c1 ts*s1 tc*s1 tc*c1}
   265 000001DE 0F12D8                  	movhlps	xmm3,xmm0
   266 000001E1 0F579D[10000000]        	xorps	xmm3,[PIC_EBP_REL(Q_MPMP)]
   267 000001E8 0F5CC3                  	subps	xmm0,xmm3	; = {--, --, s3, c3}
   268                                  
   269                                  ; {s2 s4 c4 c2} = {2*s1*c1 2*s3*c3 1-2*s3*s3 1-2*s1*s1}
   270 000001EB 0F14F0                  	unpcklps	xmm6,xmm0	; xmm6 = {s3, s1, c3, c1}
   271 000001EE 0F28FE                  	movaps	xmm7, xmm6
   272 000001F1 0FC6F6B4                	shufps	xmm6,xmm6,R4(2,3,1,0)	; xmm6 = {s1, s3, c3, c1}
   273 000001F5 0F58FF                  	addps	xmm7, xmm7		; {s3*2, s1*2,   --,   --}
   274 000001F8 8B7C2418                	mov	edi,[esp+_P+4]		; = fz
   275 000001FC 0FC6FFBE                	shufps	xmm7, xmm7, R4(2,3,3,2)	; {s1*2, s3*2, s3*2, s1*2}
   276 00000200 29DF                    	sub	edi,ebx			; edi = fz - i/2
   277 00000202 0F59FE                  	mulps	xmm7, xmm6		; {s1*s1*2, s3*s3*2, s3*c3*2, s1*c1*2}
   278 00000205 8D345F                  	lea	esi,[edi + ebx*2]	; esi = fi = fz +i/2
   279 00000208 0F5CBD[20000000]        	subps	xmm7, [PIC_EBP_REL(D_1100)]		; {-c2, -c4, s4, s2}
   280 0000020F 8D7C47FC                	lea	edi,[edi + eax*2-4]	; edi = gi = fz +k1-i/2
   281                                  
   282                                  ;                       fi = fz +i;
   283                                  ;                       gi = fz +k1-i;
   284                                  ;                       do{
   285                                  .lp220:
   286                                  ; unroll¸å¤Îdo loop¤Ï51+4Ì¿Îá
   287                                  ;                               a       = c2*fi[k1  ] + s2*gi[k1  ];
   288                                  ;                               e       = c4*fi[k1+1] + s4*gi[k1-1];
   289                                  ;                               f       = s4*fi[k1+1] - c4*gi[k1-1];
   290                                  ;                               b       = s2*fi[k1  ] - c2*gi[k1  ];
   291                                  ;                               c       = c2*fi[k3  ] + s2*gi[k3  ];
   292                                  ;                               g       = c4*fi[k3+1] + s4*gi[k3-1];
   293                                  ;                               h       = s4*fi[k3+1] - c4*gi[k3-1];
   294                                  ;                               d       = s2*fi[k3  ] - c2*gi[k3  ];
   295                                  
   296 00000213 0F28E7                  	movaps	xmm4,xmm7	; = {-c2 -c4  s4  s2}
   297 00000216 0F57A5[00000000]        	xorps	xmm4,[PIC_EBP_REL(Q_MMPP)]	; = { c2  c4  s4  s2}
   298 0000021D 0FC6E41B                	shufps	xmm4,xmm4,0x1B	; = { s2  s4  c4  c2}
   299 00000221 0F120446                	movlps	xmm0,[esi+eax*2]
   300 00000225 0F120C47                	movlps	xmm1,[edi+eax*2]
   301 00000229 0F121456                	movlps	xmm2,[esi+edx*2]
   302 0000022D 0F121C57                	movlps	xmm3,[edi+edx*2]
   303 00000231 0FC6C014                	shufps	xmm0,xmm0,0x14
   304 00000235 0FC6C941                	shufps	xmm1,xmm1,0x41
   305 00000239 0FC6D214                	shufps	xmm2,xmm2,0x14
   306 0000023D 0FC6DB41                	shufps	xmm3,xmm3,0x41
   307 00000241 0F59C4                  	mulps	xmm0,xmm4
   308 00000244 0F59CF                  	mulps	xmm1,xmm7
   309 00000247 0F59D4                  	mulps	xmm2,xmm4
   310 0000024A 0F59DF                  	mulps	xmm3,xmm7
   311 0000024D 0F58C1                  	addps	xmm0,xmm1	; xmm0 = {b, f, e, a}
   312 00000250 0F58D3                  	addps	xmm2,xmm3	; xmm2 = {d, h, g, c}
   313                                  ;17
   314                                  
   315                                  ;                               f0      = fi[0   ]    + a;
   316                                  ;                               f4      = fi[0 +1]    + e;
   317                                  ;                               g4      = gi[0 -1]    + f;
   318                                  ;                               g0      = gi[0   ]    + b;
   319                                  ;                               f1      = fi[0   ]    - a;
   320                                  ;                               f5      = fi[0 +1]    - e;
   321                                  ;                               g5      = gi[0 -1]    - f;
   322                                  ;                               g1      = gi[0   ]    - b;
   323                                  ;                               f2      = fi[k2  ]    + c;
   324                                  ;                               f6      = fi[k2+1]    + g;
   325                                  ;                               g6      = gi[k2-1]    + h;
   326                                  ;                               g2      = gi[k2  ]    + d;
   327                                  ;                               f3      = fi[k2  ]    - c;
   328                                  ;                               f7      = fi[k2+1]    - g;
   329                                  ;                               g7      = gi[k2-1]    - h;
   330                                  ;                               g3      = gi[k2  ]    - d;
   331 00000253 0F120E                  	movlps	xmm1,[esi      ]
   332 00000256 0F160F                  	movhps	xmm1,[edi      ]
   333 00000259 0F28E1                  	movaps	xmm4,xmm1
   334 0000025C 0F5CC8                  	subps	xmm1,xmm0	; xmm1 = {g1, g5, f5, f1}
   335 0000025F 0F121C86                	movlps	xmm3,[esi+eax*4]
   336 00000263 0F161C87                	movhps	xmm3,[edi+eax*4]
   337 00000267 0F28EB                  	movaps	xmm5,xmm3
   338 0000026A 0F5CDA                  	subps	xmm3,xmm2	; xmm3 = {g3, g7, f7, f3}
   339 0000026D 0F58C4                  	addps	xmm0,xmm4	; xmm0 = {g0, g4, f4, f0}
   340 00000270 0F58D5                  	addps	xmm2,xmm5	; xmm2 = {g2, g6, f6, f2}
   341                                  ;10
   342                                  
   343                                  ;                               a       = c1*f2     + s1*g3;	½ç*½ç + µÕ*µÕ
   344                                  ;                               e       = c3*f6     + s3*g7;
   345                                  ;                               g       = s3*g6     + c3*f7;
   346                                  ;                               c       = s1*g2     + c1*f3;
   347                                  ;                               d       = c1*g2     - s1*f3;	½ç*µÕ - µÕ*½ç
   348                                  ;                               h       = c3*g6     - s3*f7;
   349                                  ;                               f       = s3*f6     - c3*g7;
   350                                  ;                               b       = s1*f2     - c1*g3;
   351                                  
   352 00000273 0F28EE                  	movaps	xmm5,xmm6	; xmm6 = {s1, s3, c3, c1}
   353 00000276 0FC6ED1B                	shufps	xmm5,xmm5,0x1B	; = {c1, c3, s3, s1}
   354 0000027A 0F28E2                  	movaps	xmm4,xmm2
   355 0000027D 0F59E6                  	mulps	xmm4,xmm6
   356 00000280 0FC6D21B                	shufps	xmm2,xmm2,0x1B	; xmm2 = {f2, f6, g6, g2}
   357 00000284 0F59D6                  	mulps	xmm2,xmm6
   358 00000287 0F59EB                  	mulps	xmm5,xmm3
   359 0000028A 0F59DE                  	mulps	xmm3,xmm6
   360 0000028D 0FC6DB1B                	shufps	xmm3,xmm3,0x1B
   361 00000291 0F58E3                  	addps	xmm4,xmm3	; = {c, g, e, a}
   362 00000294 0F5CD5                  	subps	xmm2,xmm5	; = {b, f, h, d}
   363                                  ;10
   364                                  
   365                                  ;                               fi[0   ]  = f0        + a;
   366                                  ;                               fi[0 +1]  = f4        + e;
   367                                  ;                               gi[0 -1]  = g4        + g;
   368                                  ;                               gi[0   ]  = g0        + c;
   369                                  ;                               fi[k2  ]  = f0        - a;
   370                                  ;                               fi[k2+1]  = f4        - e;
   371                                  ;                               gi[k2-1]  = g4        - g;
   372                                  ;                               gi[k2  ]  = g0        - c;
   373                                  ;                               fi[k1  ]  = f1        + d;
   374                                  ;                               fi[k1+1]  = f5        + h;
   375                                  ;                               gi[k1-1]  = g5        + f;
   376                                  ;                               gi[k1  ]  = g1        + b;
   377                                  ;                               fi[k3  ]  = f1        - d;
   378                                  ;                               fi[k3+1]  = f5        - h;
   379                                  ;                               gi[k3-1]  = g5        - f;
   380                                  ;                               gi[k3  ]  = g1        - b;
   381 00000297 0F28D8                  	movaps	xmm3,xmm0
   382 0000029A 0F5CC4                  	subps	xmm0,xmm4
   383 0000029D 0F130486                	movlps	[esi+eax*4],xmm0
   384 000002A1 0F170487                	movhps	[edi+eax*4],xmm0
   385 000002A5 0F58E3                  	addps	xmm4,xmm3
   386 000002A8 0F1326                  	movlps	[esi      ],xmm4
   387 000002AB 0F1727                  	movhps	[edi      ],xmm4
   388                                  
   389 000002AE 0F28E9                  	movaps	xmm5,xmm1
   390 000002B1 0F5CCA                  	subps	xmm1,xmm2
   391 000002B4 0F130C56                	movlps	[esi+edx*2],xmm1
   392 000002B8 0F170C57                	movhps	[edi+edx*2],xmm1
   393 000002BC 0F58D5                  	addps	xmm2,xmm5
   394 000002BF 0F131446                	movlps	[esi+eax*2],xmm2
   395 000002C3 0F171447                	movhps	[edi+eax*2],xmm2
   396                                  ; 14
   397                                  ;                               gi     += k4;
   398                                  ;                               fi     += k4;
   399 000002C7 8D3CC7                  	lea	edi,[edi + eax*8] ; gi += (k1 * 4);
   400 000002CA 8D34C6                  	lea	esi,[esi + eax*8] ; fi += (k1 * 4);
   401 000002CD 3B3424                  	cmp	esi,[esp]
   402 000002D0 0F8C3DFFFFFF            	jl	near .lp220		; while (fi<fn);
   403                                  ;                       } while (fi<fn);
   404                                  
   405 000002D6 83C308                  	add	ebx,byte 2*4	; i+= 4
   406 000002D9 39C3                    	cmp	ebx,eax		; i < k1
   407 000002DB 0FC6F669                	shufps	xmm6,xmm6,R4(1,2,2,1)	; (--,s3,c3,--) => {c3, s3, s3, c3}
   408 000002DF 0F8CDBFEFFFF            	jl	near .lp22
   409                                  ;               }
   410                                  .F22:
   411 000002E5 C1E002                  	shl	eax,2
   412 000002E8 83C108                  	add	ecx, byte 8
   413 000002EB 3B44241C                	cmp	eax,[esp+_P+8]	; while ((k1 * 4)<n);
   414 000002EF 0F8E42FDFFFF            	jle	near .lp2
   415 000002F5 5D                      	pop	ebp
   416 000002F6 5D                      	pop	ebp
   417 000002F7 5F                      	pop	edi
   418 000002F8 5E                      	pop	esi
   419 000002F9 5B                      	pop	ebx
   420 000002FA C3                      	ret
   421                                  
   422                                  	end
   422          ******************       warning: label alone on a line without a colon might be in error [-w+orphan-labels]
